import{a as H}from"./chunk-D5TDNWAN.js";import{a as Y,b as Z,c as ee,d as te,e as ie,f as ne,g as oe,h as re,i as ce}from"./chunk-LZ42FOSW.js";import"./chunk-GZE5FUQ2.js";import"./chunk-RFW3ZCTE.js";import{Ca as o,Da as r,Ea as m,Ec as Q,Fa as L,Ga as $,Ia as b,Ib as A,J as E,Ja as v,Ka as l,Kb as q,Lb as z,Mb as G,O as x,Oa as k,Oc as W,P as C,Pc as X,Ua as S,Va as s,Wa as u,Xa as h,_a as M,aa as D,h as T,ia as c,ib as y,ja as g,jb as F,kb as O,m as w,mb as V,sb as j,ta as d,tb as B,va as p,vc as J,wb as R,xb as N,yb as U,zc as K}from"./chunk-ERFA3NGG.js";import{a as I,b as P}from"./chunk-CWTPBX7D.js";function ae(e,n){if(e&1&&m(0,"p-sortIcon",15),e&2){let t=l().$implicit;p("field",t.field)}}function le(e,n){if(e&1&&(o(0,"th",13),d(1,ae,1,1,"p-sortIcon",14),s(2),r()),e&2){let t=n.$implicit,i=n.index;p("pSortableColumn",t.field)("pSortableColumnDisabled",i===1),c(),p("ngIf",t.field!=="image"),c(),h(" ",t.header," ")}}function pe(e,n){if(e&1&&(o(0,"tr"),d(1,le,3,4,"th",12),o(2,"th"),s(3,"Actions"),r()()),e&2){let t=n.$implicit;c(),p("ngForOf",t)}}function se(e,n){if(e&1&&(L(0),s(1),$()),e&2){let t=l().$implicit,i=l().$implicit;c(),u(i[t.field])}}function me(e,n){if(e&1&&m(0,"img",21),e&2){let t=l().$implicit,i=l().$implicit;p("src",i[t.field],D)}}function de(e,n){if(e&1&&(o(0,"span"),s(1),r()),e&2){let t=l().$implicit,i=l().$implicit;c(),h(" ",i[t.field],"")}}function _e(e,n){if(e&1&&(o(0,"span"),s(1),y(2,"date"),r()),e&2){let t=l().$implicit,i=l().$implicit;c(),h(" ",O(2,1,i[t.field],"dd/MM/yyyy"),"")}}function ue(e,n){if(e&1&&(o(0,"span"),s(1),y(2,"currency"),r()),e&2){let t=l().$implicit,i=l().$implicit;c(),u(F(2,1,i[t.field]))}}function fe(e,n){if(e&1&&(o(0,"span"),s(1),r()),e&2){let t=l().$implicit,i=l().$implicit;c(),u(i[t.field])}}function ge(e,n){if(e&1&&(o(0,"td"),d(1,se,2,1,"ng-container",19)(2,me,1,1,"img",20)(3,de,2,1,"span",19)(4,_e,3,4,"span",19)(5,ue,3,3,"span",19)(6,fe,2,1,"span",19),r()),e&2){let t=n.$implicit;c(),p("ngIf",t.field==="name"),c(),p("ngIf",t.field==="image"),c(),p("ngIf",t.field==="category"),c(),p("ngIf",t.field==="dateCreated"),c(),p("ngIf",t.field==="price"),c(),p("ngIf",t.field!=="image"&&t.field!=="name"&&t.field!=="category"&&t.field!=="dateCreated"&&t.field!=="price")}}function xe(e,n){if(e&1){let t=b();o(0,"tr"),d(1,ge,7,6,"td",16),o(2,"td")(3,"p-button",17),v("click",function(){let _=x(t).$implicit,f=l(2);return C(f.onDeleteProduct(_.id))}),r(),m(4,"p-button",18),r()()}if(e&2){let t=n.$implicit,i=n.columns;c(),p("ngForOf",i),c(3),k("routerLink","/products/form/",t.id,"")}}function Ce(e,n){if(e&1&&(o(0,"section",4)(1,"div",5)(2,"h1"),s(3,"Products"),r(),o(4,"p"),s(5,"List of all products"),r()(),o(6,"div",6)(7,"button",7),m(8,"i",8),o(9,"span"),s(10,"New"),r()()(),o(11,"p-table",9),d(12,pe,4,1,"ng-template",10)(13,xe,5,2,"ng-template",11),r()()),e&2){let t=l();c(11),p("paginator",!0)("rows",10)("showCurrentPageReport",!0)("columns",t.cols)("value",t.products)}}function ve(e,n){e&1&&(o(0,"div",22)(1,"p"),m(2,"i",23),r()())}function Se(e,n){if(e&1){let t=b();o(0,"div",24)(1,"div",25),m(2,"i",26),r(),o(3,"span",27),s(4),r(),o(5,"p",28),s(6),r(),o(7,"div",29)(8,"button",30),v("click",function(){x(t),l();let a=S(5);return C(a.accept())}),r(),o(9,"button",31),v("click",function(){x(t),l();let a=S(5);return C(a.reject())}),r()()()}if(e&2){let t=n.$implicit;c(4),u(t.header),c(2),u(t.message)}}var Be=(()=>{let n=class n{constructor(i,a,_,f){this.confirmationService=i,this.productsService=a,this.messageService=_,this.router=f,this.cols=[{field:"name",header:"Name"},{field:"image",header:"Image"},{field:"price",header:"Price"},{field:"countInStock",header:"Stock"},{field:"category",header:"Category"},{field:"dateCreated",header:"Created at"}]}ngOnInit(){this.getProducts(),this.listenUrlChanges()}getProducts(){this.productsService.getProducts(),this.productsService.products$.pipe(T(i=>i.map(a=>P(I({},a),{category:a.category.name})))).subscribe({next:i=>{this.products=i}})}onDeleteProduct(i){this.confirmationService.confirm({header:"Delete Product",message:"Are you sure you want to delete this Product?",accept:()=>{this.productsService.deleteProduct(i).subscribe({next:a=>{this.products=this.products.filter(_=>_.id!==a.id),this.messageService.add({severity:"success",summary:"Success",detail:`The product "${a.name}" is deleted successfully!`})},error:a=>{console.error("Cannot delete product",a)}})},reject:()=>{}})}listenUrlChanges(){this.urlChangesSubscription=this.router.events.pipe(w(i=>i instanceof A)).subscribe({next:()=>{this.getProducts()},error:i=>{console.error("Cannot get url changes!",i)}})}ngOnDestroy(){this.urlChangesSubscription?.unsubscribe()}};n.\u0275fac=function(a){return new(a||n)(g(J),g(H),g(K),g(z))},n.\u0275cmp=E({type:n,selectors:[["admin-product-list"]],standalone:!0,features:[M],decls:8,vars:2,consts:[["class","products-page",4,"ngIf","ngIfElse"],["loader",""],["cd",""],["pTemplate","headless"],[1,"products-page"],[1,"name-page"],[1,"btn-container"],["routerLink","/products/form",1,"btn-create-edit-product"],[1,"pi","pi-plus"],[1,"p-table",3,"paginator","rows","showCurrentPageReport","columns","value"],["pTemplate","header"],["pTemplate","body"],[3,"pSortableColumn","pSortableColumnDisabled",4,"ngFor","ngForOf"],[3,"pSortableColumn","pSortableColumnDisabled"],[3,"field",4,"ngIf"],[3,"field"],[4,"ngFor","ngForOf"],["styleClass","p-button-trash","icon","pi pi-trash",3,"click"],["styleClass","p-button-pencil","icon","pi pi-pencil",3,"routerLink"],[4,"ngIf"],["alt","product",3,"src",4,"ngIf"],["alt","product",3,"src"],[1,"loader-container"],[1,"pi","pi-spin","pi-spinner"],[1,"confirm-modal","flex","flex-column","align-items-center","p-5","border-round"],[1,"icon","border-circle","inline-flex","justify-content-center","align-items-center","h-6rem","w-6rem","-mt-8"],[1,"pi","pi-question","text-5xl"],[1,"font-bold","text-2xl","block","mb-2","mt-4"],[1,"mb-0"],[1,"flex","align-items-center","gap-2","mt-4"],["pButton","","label","Save",1,"w-8rem",3,"click"],["pButton","","label","Cancel",1,"p-button-outlined","w-8rem",3,"click"]],template:function(a,_){if(a&1&&(d(0,Ce,14,5,"section",0)(1,ve,3,0,"ng-template",null,1,V),m(3,"p-toast"),o(4,"p-confirmDialog",null,2),d(6,Se,10,2,"ng-template",3),r(),m(7,"router-outlet")),a&2){let f=S(2);p("ngIf",_.products)("ngIfElse",f)}},dependencies:[U,j,B,N,R,G,q,ee,Y,Z,Q,X,W,ie,te,ce,ne,oe,re]});let e=n;return e})();export{Be as ProductListComponent};
