import{a as le,b as be,c as Pe,d as ye,e as Ie,f as we,g as Ee,h as Le,i as ke,j as Te}from"./chunk-HVJQZFG7.js";import"./chunk-5L25SNYF.js";import{a as ve,b as Se}from"./chunk-4PAJVUNI.js";import{a as se}from"./chunk-LRFJEYFV.js";import{I as xe,M as he,R as Ce,b as pe,e as de,f as me,g as ue,h as _e,i as ge,n as fe}from"./chunk-PGUS56OB.js";import"./chunk-QZRC2FX4.js";import{$a as _,Da as w,Db as K,Ea as E,Eb as X,Fa as L,Fb as Y,Ga as k,Ha as o,Ia as n,Ib as Z,Ja as m,Jb as ee,Ka as Q,Kb as te,La as A,Na as C,Oa as h,P as O,Pa as s,Sa as U,Ta as T,Ub as ie,Vb as ne,Wb as re,X as g,Xb as oe,Y as f,Ya as S,Yb as ce,Za as l,_a as v,ac as ae,b as R,bb as q,cb as W,db as G,fb as H,gb as D,ha as I,hb as F,i as y,ja as a,ka as x,p as j,pb as b,qb as $,rb as V,s as N,tb as M,va as u,wb as J,xa as p}from"./chunk-CW4CGSOG.js";import{a as B,b as z}from"./chunk-6DTZ7UCQ.js";var De=()=>[],Fe=t=>({active:t});function Be(t,r){t&1&&(o(0,"div",15)(1,"p"),m(2,"i",16),n()())}function ze(t,r){if(t&1&&m(0,"p-sortIcon",23),t&2){let e=s().$implicit;p("field",e.field)}}function Re(t,r){if(t&1&&(o(0,"th",21),u(1,ze,1,1,"p-sortIcon",22),l(2),n()),t&2){let e=r.$implicit,i=r.index;p("pSortableColumn",e.field)("pSortableColumnDisabled",i===1),a(),p("ngIf",e.field!=="image"),a(),_(" ",e.header," ")}}function je(t,r){if(t&1&&(o(0,"tr"),u(1,Re,3,4,"th",20),o(2,"th"),l(3,"Actions"),n()()),t&2){let e=r.$implicit;a(),p("ngForOf",e)}}function Ne(t,r){if(t&1&&(Q(0),l(1),A()),t&2){let e=s().$implicit,i=s().$implicit;a(),v(i[e.field])}}function Oe(t,r){if(t&1&&m(0,"img",29),t&2){let e=s().$implicit,i=s().$implicit;p("src",i[e.field],I)}}function Qe(t,r){if(t&1&&(o(0,"span"),l(1),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),_(" ",i[e.field],"")}}function Ae(t,r){if(t&1&&(o(0,"span"),l(1),b(2,"date"),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),_(" ",V(2,1,i[e.field],"dd/MM/yyyy"),"")}}function Ue(t,r){if(t&1&&(o(0,"span"),l(1),b(2,"currency"),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),v($(2,1,i[e.field]))}}function qe(t,r){if(t&1&&(o(0,"span"),l(1),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),v(i[e.field])}}function We(t,r){if(t&1&&(o(0,"td"),u(1,Ne,2,1,"ng-container",27)(2,Oe,1,1,"img",28)(3,Qe,2,1,"span",27)(4,Ae,3,4,"span",27)(5,Ue,3,3,"span",27)(6,qe,2,1,"span",27),n()),t&2){let e=r.$implicit;a(),p("ngIf",e.field==="name"),a(),p("ngIf",e.field==="image"),a(),p("ngIf",e.field==="category"),a(),p("ngIf",e.field==="dateCreated"),a(),p("ngIf",e.field==="price"),a(),p("ngIf",e.field!=="image"&&e.field!=="name"&&e.field!=="category"&&e.field!=="dateCreated"&&e.field!=="price")}}function Ge(t,r){if(t&1){let e=C();o(0,"tr"),u(1,We,7,6,"td",24),o(2,"td")(3,"p-button",25),h("click",function(){let c=g(e).$implicit,d=s(3);return f(d.onDeleteProduct(c.id))}),n(),m(4,"p-button",26),n()()}if(t&2){let e=r.$implicit,i=r.columns;a(),p("ngForOf",i),a(3),T("routerLink","/products/form/",e.id,"")}}function He(t,r){if(t&1&&(o(0,"p-table",17),u(1,je,4,1,"ng-template",18)(2,Ge,5,3,"ng-template",19),n()),t&2){let e=s(2);p("paginator",!0)("rows",10)("showCurrentPageReport",!0)("columns",e.cols)("value",e.products)}}function Je(t,r){t&1&&(o(0,"div",13),l(1,"No Products were found!"),n())}function Ke(t,r){if(t&1){let e=C();o(0,"li",34)(1,"button",35),h("click",function(){let c=g(e).$index,d=s(4);return f(d.onClickPage(c))}),l(2),n()()}if(t&2){let e=r.$index,i=s(4);p("ngClass",F(2,Fe,e+1+""===i.currPage)),a(2),_(" ",e+1," ")}}function Xe(t,r){if(t&1&&(o(0,"ul",33),L(1,Ke,3,4,"li",34,E),n()),t&2){let e=s(3);a(),k(D(0,De).constructor(e.pageCount))}}function Ye(t,r){if(t&1){let e=C();o(0,"li",38)(1,"div",39)(2,"div",40)(3,"h1"),l(4),n(),m(5,"img",29),n()(),o(6,"div",41)(7,"div",42)(8,"p",43)(9,"span"),l(10,"Price"),n(),l(11),b(12,"currency"),n(),o(13,"p",44)(14,"span"),l(15,"Stock"),n(),l(16),n()(),o(17,"div",45)(18,"p",46)(19,"span"),l(20,"Category"),n(),l(21),n(),o(22,"p",47)(23,"span"),l(24,"Date"),n(),l(25),b(26,"date"),n()(),o(27,"div",48)(28,"button",49),m(29,"i",50),n(),o(30,"button",51),h("click",function(){let c=g(e).$implicit,d=s(4);return f(d.onDeleteProduct(c.id))}),m(31,"i",52),n()()()()}if(t&2){let e=r.$implicit;a(4),v(e.name),a(),U("src",e.image,I),a(6),_(" ",$(12,8,e.price)," "),a(5),_(" ",e.countInStock," "),a(5),_(" ",e.category," "),a(4),_(" ",V(26,10,e.dateCreated,"dd/MM/yyyy")," "),a(3),T("routerLink","/products/form/",e.id,"")}}function Ze(t,r){t&1&&(o(0,"div",13),l(1,"No Products were found!"),n())}function et(t,r){if(t&1&&(o(0,"ul",36),u(1,Ye,32,13,"li",37)(2,Ze,2,0,"div",13),n()),t&2){let e=s(3);a(),p("ngForOf",e.products)("ngForTrackBy",e.trackByProductId),a(),w(e.products.length?-1:2)}}function tt(t,r){if(t&1){let e=C();o(0,"li",34)(1,"button",35),h("click",function(){let c=g(e).$index,d=s(4);return d.setQueryParams({currPage:c+1+""}),f(d.isLoading=!0)}),l(2),n()()}if(t&2){let e=r.$index,i=s(4);p("ngClass",F(2,Fe,e+1+""===i.currPage)),a(2),_(" ",e+1," ")}}function it(t,r){if(t&1&&(o(0,"ul",33),L(1,tt,3,4,"li",34,E),n()),t&2){let e=s(3);a(),k(D(0,De).constructor(e.pageCount))}}function nt(t,r){t&1&&(o(0,"div",15)(1,"p"),m(2,"i",16),n()())}function rt(t,r){if(t&1&&(o(0,"div",30),u(1,Xe,3,1,"ul",31)(2,et,3,3,"ul",32)(3,it,3,1,"ul",31)(4,nt,3,0,"ng-template",null,0,M),n()),t&2){let e=S(5),i=s(2);a(),p("ngIf",i.pageCount!==void 0&&i.products.length&&!i.isLoading),a(),p("ngIf",!i.isLoading)("ngIfElse",e),a(),p("ngIf",i.pageCount!==void 0&&i.products.length&&!i.isLoading)}}function ot(t,r){if(t&1){let e=C();o(0,"section",4)(1,"div",5)(2,"h1"),l(3,"Products"),n(),o(4,"p"),l(5,"List of all products"),n()(),o(6,"div",6)(7,"button",7),m(8,"i",8),o(9,"span"),l(10,"New"),n()(),o(11,"form",9)(12,"input",10),G("ngModelChange",function(c){g(e);let d=s();return W(d.filterBy.name,c)||(d.filterBy.name=c),f(c)}),h("ngModelChange",function(){g(e);let c=s();return f(c.onSearchProducts())}),n(),u(13,Be,3,0,"div",11),n()(),u(14,He,3,5,"p-table",12)(15,Je,2,0,"div",13)(16,rt,6,4,"div",14),n()}if(t&2){let e=s();a(12),q("ngModel",e.filterBy.name),a(),p("ngIf",e.isDesktop&&e.isLoading),a(),p("ngIf",e.isDesktop),a(),w(e.isDesktop&&!e.products.length?15:-1),a(),p("ngIf",!e.isDesktop)}}function ct(t,r){t&1&&(o(0,"div",15)(1,"p"),m(2,"i",16),n()())}function at(t,r){if(t&1){let e=C();o(0,"div",53)(1,"div",54),m(2,"i",55),n(),o(3,"span",56),l(4),n(),o(5,"p",57),l(6),n(),o(7,"div",58)(8,"button",59),h("click",function(){g(e),s();let c=S(5);return f(c.accept())}),n(),o(9,"button",60),h("click",function(){g(e),s();let c=S(5);return f(c.reject())}),n()()()}if(t&2){let e=r.$implicit;a(4),v(e.header),a(2),v(e.message)}}var Lt=(()=>{let r=class r{constructor(i,c,d,P,$e,Ve,Me){this.confirmationService=i,this.productsService=c,this.messageService=d,this.router=P,this.viewportSizeService=$e,this.changeDetectorRef=Ve,this.route=Me,this.cols=[{field:"name",header:"Name"},{field:"image",header:"Image"},{field:"price",header:"Price"},{field:"countInStock",header:"Stock"},{field:"category",header:"Category"},{field:"dateCreated",header:"Created at"}],this.currPage="1",this.pageSize="10",this.isFirstOnInit=!0,this.isLoading=!1,this.filterBy={categories:[],name:""},this.searchProductsSubject=new R}ngOnInit(){this._observeProducts(),this._observeViewportSize(),this.listenUrlChanges(),this._observeSearchProducts(),this.isDesktop||(this._observeQueryParams(),this.setQueryParams({currPage:this.currPage})),this.isDesktop&&this._observeQueryParams()}_observeSearchProducts(){this.searchProductsSubject.pipe(N(500)).subscribe({next:()=>{this.productsService.setFilterBy(this.filterBy),this.getProducts()}})}onSearchProducts(){this.isLoading=!0,this.searchProductsSubject.next("")}_observeQueryParams(){this.queryParamsSubscription=this.route.queryParams.subscribe(i=>{this.currPage=i.currPage||this.currPage,this.pageSize=i.pageSize||this.pageSize,this.getProducts()})}setQueryParams(i={}){this.router.navigate([],{relativeTo:this.route,queryParams:{currPage:i.currPage,pageSize:i.pageSize===""?i.pageSize:this.pageSize},queryParamsHandling:"merge"})}onClickPage(i){i+1!==+this.currPage&&(this.setQueryParams({currPage:i+1+""}),this.isLoading=!0)}_observeViewportSize(){this.viewportSubscription=this.viewportSizeService.viewportWidth$.pipe(y(i=>i>=1025)).subscribe(i=>{this.isDesktop=i,i?this.setQueryParams({currPage:"",pageSize:""}):this.setQueryParams({currPage:this.currPage,pageSize:this.pageSize})})}getProducts(){this.isDesktop?this.productsService.getProducts():this.productsService.getProducts({currPage:this.currPage,pageSize:this.pageSize})}_observeProducts(){this.productsSubscription=this.productsService.products$.pipe(y(i=>i instanceof Array&&!i.length?[]:(this.pageCount=i.pageCount,i.products.map(c=>z(B({},c),{category:c.category.name}))))).subscribe({next:i=>{if(this.isFirstOnInit){this.isFirstOnInit=!1;return}this.products=i,this.isLoading=!1,this.changeDetectorRef.markForCheck()},error:i=>{console.error("Cannot get products",i)}})}onDeleteProduct(i){this.confirmationService.confirm({header:"Delete Product",message:"Are you sure you want to delete this Product?",accept:()=>{this.productsService.deleteProduct(i).subscribe({next:c=>{this.products=this.products.filter(d=>d.id!==c.id),this.messageService.add({severity:"success",summary:"Success",detail:`The product "${c.name}" is deleted successfully!`}),this.changeDetectorRef.markForCheck()},error:c=>{console.error("Cannot delete product",c)}})},reject:()=>{}})}listenUrlChanges(){let i=this.router.url.split("?")[0];this.urlChangesSubscription=this.router.events.pipe(j(c=>c instanceof ie)).subscribe({next:c=>{let d=c.url.split("?")[0];d!==i&&(this.getProducts(),i=d)},error:c=>{console.error("Cannot get url changes!",c)}})}trackByProductId(i,c){return c.id}ngOnDestroy(){this.urlChangesSubscription?.unsubscribe(),this.viewportSubscription?.unsubscribe(),this.queryParamsSubscription?.unsubscribe(),this.productsSubscription?.unsubscribe()}};r.\u0275fac=function(c){return new(c||r)(x(xe),x(se),x(he),x(oe),x(le),x(J),x(ne))},r.\u0275cmp=O({type:r,selectors:[["admin-product-list"]],standalone:!0,features:[H],decls:8,vars:2,consts:[["loader",""],["cd",""],["class","products-page",4,"ngIf","ngIfElse"],["pTemplate","headless"],[1,"products-page"],[1,"name-page"],[1,"btn-container"],["routerLink","/products/form",1,"btn-create-edit-product"],[1,"pi","pi-plus"],[1,"search-form"],["type","text","name","name","placeholder","Search Products...",3,"ngModelChange","ngModel"],["class","loader-container",4,"ngIf"],["class","p-table",3,"paginator","rows","showCurrentPageReport","columns","value",4,"ngIf"],[1,"no-products"],["class","products-tablet-mobile",4,"ngIf"],[1,"loader-container"],[1,"pi","pi-spin","pi-spinner"],[1,"p-table",3,"paginator","rows","showCurrentPageReport","columns","value"],["pTemplate","header"],["pTemplate","body"],[3,"pSortableColumn","pSortableColumnDisabled",4,"ngFor","ngForOf"],[3,"pSortableColumn","pSortableColumnDisabled"],[3,"field",4,"ngIf"],[3,"field"],[4,"ngFor","ngForOf"],["styleClass","p-button-trash","icon","pi pi-trash",3,"click"],["styleClass","p-button-pencil","icon","pi pi-pencil",3,"routerLink"],[4,"ngIf"],["alt","product",3,"src",4,"ngIf"],["alt","product",3,"src"],[1,"products-tablet-mobile"],["class","pages",4,"ngIf"],["class","product-list",4,"ngIf","ngIfElse"],[1,"pages"],[3,"ngClass"],[3,"click"],[1,"product-list"],["class","product",4,"ngFor","ngForOf","ngForTrackBy"],[1,"product"],[1,"row-1"],[1,"name-img-container"],[1,"row-2"],[1,"price-stock-container"],[1,"price"],[1,"stock"],[1,"category-date-container"],[1,"category"],[1,"date"],[1,"actions"],[1,"btn-edit-product",3,"routerLink"],[1,"pi","pi-pencil"],[1,"btn-delete-product",3,"click"],[1,"pi","pi-trash"],[1,"confirm-modal","flex","flex-column","align-items-center","p-5","border-round"],[1,"icon","border-circle","inline-flex","justify-content-center","align-items-center","h-6rem","w-6rem","-mt-8"],[1,"pi","pi-question","text-5xl"],[1,"font-bold","text-2xl","block","mb-2","mt-4"],[1,"mb-0"],[1,"flex","align-items-center","gap-2","mt-4"],["pButton","","label","Save",1,"w-8rem",3,"click"],["pButton","","label","Cancel",1,"p-button-outlined","w-8rem",3,"click"]],template:function(c,d){if(c&1&&(u(0,ot,17,5,"section",2)(1,ct,3,0,"ng-template",null,0,M),m(3,"p-toast"),o(4,"p-confirmDialog",null,1),u(6,at,10,2,"ng-template",3),n(),m(7,"router-outlet")),c&2){let P=S(2);p("ngIf",d.products&&d.isDesktop!==void 0)("ngIfElse",P)}},dependencies:[te,K,X,Y,ee,Z,ae,re,ce,ye,be,Pe,Ce,Se,ve,we,Ie,Te,Ee,Le,ke,fe,ge,pe,de,me,_e,ue],changeDetection:0});let t=r;return t})();export{Lt as ProductListComponent};
