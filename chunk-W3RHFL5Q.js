import{a as Z}from"./chunk-TPH2KBHV.js";import{a as re,b as ce,c as ae,d as le,e as pe,f as se,g as me,h as de,i as _e}from"./chunk-IZD4GX7W.js";import"./chunk-TIMMUOPY.js";import"./chunk-SHWCDSVJ.js";import{A as R,Ab as H,Bb as J,Cc as te,Fa as r,G as V,Ga as o,Ha as m,Hc as ie,Ia as O,Ja as W,La as y,Lb as K,M,Ma as b,Na as p,Nb as Q,Ob as X,Pb as Y,Qa as z,R as h,Ra as P,Rc as ne,S as C,Sc as oe,Xa as I,Ya as l,Za as x,_a as u,bb as N,c as L,da as w,h as v,k as $,la as c,lb as S,ma as g,mb as k,n as F,na as j,nb as E,pb as U,q as B,vb as A,wa as _,wb as q,ya as s,yc as ee,zb as G}from"./chunk-7I2OQVDN.js";import{a as D,b as T}from"./chunk-CWTPBX7D.js";var ue=(()=>{let n=class n{constructor(){this._viewportWidth$=new L(window.innerWidth),this.viewportWidth$=this._viewportWidth$.asObservable(),$(window,"resize").pipe(B(150),v(i=>i.target.innerWidth),R(window.innerWidth)).subscribe({next:i=>this._viewportWidth$.next(i)})}};n.\u0275fac=function(a){return new(a||n)},n.\u0275prov=V({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();function ve(t,n){if(t&1&&m(0,"p-sortIcon",17),t&2){let e=p().$implicit;s("field",e.field)}}function he(t,n){if(t&1&&(r(0,"th",15),_(1,ve,1,1,"p-sortIcon",16),l(2),o()),t&2){let e=n.$implicit,i=n.index;s("pSortableColumn",e.field)("pSortableColumnDisabled",i===1),c(),s("ngIf",e.field!=="image"),c(),u(" ",e.header," ")}}function Ce(t,n){if(t&1&&(r(0,"tr"),_(1,he,3,4,"th",14),r(2,"th"),l(3,"Actions"),o()()),t&2){let e=n.$implicit;c(),s("ngForOf",e)}}function be(t,n){if(t&1&&(O(0),l(1),W()),t&2){let e=p().$implicit,i=p().$implicit;c(),x(i[e.field])}}function Se(t,n){if(t&1&&m(0,"img",23),t&2){let e=p().$implicit,i=p().$implicit;s("src",i[e.field],w)}}function ye(t,n){if(t&1&&(r(0,"span"),l(1),o()),t&2){let e=p().$implicit,i=p().$implicit;c(),u(" ",i[e.field],"")}}function Ie(t,n){if(t&1&&(r(0,"span"),l(1),S(2,"date"),o()),t&2){let e=p().$implicit,i=p().$implicit;c(),u(" ",E(2,1,i[e.field],"dd/MM/yyyy"),"")}}function we(t,n){if(t&1&&(r(0,"span"),l(1),S(2,"currency"),o()),t&2){let e=p().$implicit,i=p().$implicit;c(),x(k(2,1,i[e.field]))}}function Pe(t,n){if(t&1&&(r(0,"span"),l(1),o()),t&2){let e=p().$implicit,i=p().$implicit;c(),x(i[e.field])}}function ke(t,n){if(t&1&&(r(0,"td"),_(1,be,2,1,"ng-container",21)(2,Se,1,1,"img",22)(3,ye,2,1,"span",21)(4,Ie,3,4,"span",21)(5,we,3,3,"span",21)(6,Pe,2,1,"span",21),o()),t&2){let e=n.$implicit;c(),s("ngIf",e.field==="name"),c(),s("ngIf",e.field==="image"),c(),s("ngIf",e.field==="category"),c(),s("ngIf",e.field==="dateCreated"),c(),s("ngIf",e.field==="price"),c(),s("ngIf",e.field!=="image"&&e.field!=="name"&&e.field!=="category"&&e.field!=="dateCreated"&&e.field!=="price")}}function Ee(t,n){if(t&1){let e=y();r(0,"tr"),_(1,ke,7,6,"td",18),r(2,"td")(3,"p-button",19),b("click",function(){let d=h(e).$implicit,f=p(3);return C(f.onDeleteProduct(d.id))}),o(),m(4,"p-button",20),o()()}if(t&2){let e=n.$implicit,i=n.columns;c(),s("ngForOf",i),c(3),P("routerLink","/products/form/",e.id,"")}}function De(t,n){if(t&1&&(r(0,"p-table",11),_(1,Ce,4,1,"ng-template",12)(2,Ee,5,2,"ng-template",13),o()),t&2){let e=p(2);s("paginator",!0)("rows",10)("showCurrentPageReport",!0)("columns",e.cols)("value",e.products)}}function Te(t,n){if(t&1){let e=y();r(0,"li",27)(1,"div",28)(2,"div",29)(3,"h1"),l(4),o(),m(5,"img",23),o()(),r(6,"div",30)(7,"div",31)(8,"p",32)(9,"span"),l(10,"Price"),o(),l(11),S(12,"currency"),o(),r(13,"p",33)(14,"span"),l(15,"Stock"),o(),l(16),o()(),r(17,"div",34)(18,"p",35)(19,"span"),l(20,"Category"),o(),l(21),o(),r(22,"p",36)(23,"span"),l(24,"Date"),o(),l(25),S(26,"date"),o()(),r(27,"div",37)(28,"button",38),m(29,"i",39),o(),r(30,"button",40),b("click",function(){let d=h(e).$implicit,f=p(3);return C(f.onDeleteProduct(d.id))}),m(31,"i",41),o()()()()}if(t&2){let e=n.$implicit;c(4),x(e.name),c(),z("src",e.image,w),c(6),u(" ",k(12,7,e.price)," "),c(5),u(" ",e.countInStock," "),c(5),u(" ",e.category," "),c(4),u(" ",E(26,9,e.dateCreated,"dd/MM/yyyy")," "),c(3),P("routerLink","/products/form/",e.id,"")}}function Le(t,n){if(t&1&&(r(0,"div",24)(1,"ul",25),_(2,Te,32,12,"li",26),o()()),t&2){let e=p(2);c(2),s("ngForOf",e.products)("ngForTrackBy",e.trackByProductId)}}function $e(t,n){if(t&1&&(r(0,"section",4)(1,"div",5)(2,"h1"),l(3,"Products"),o(),r(4,"p"),l(5,"List of all products"),o()(),r(6,"div",6)(7,"button",7),m(8,"i",8),r(9,"span"),l(10,"New"),o()()(),_(11,De,3,5,"p-table",9)(12,Le,3,2,"div",10),o()),t&2){let e=p();c(11),s("ngIf",e.isDesktop),c(),s("ngIf",!e.isDesktop)}}function Fe(t,n){t&1&&(r(0,"div",42)(1,"p"),m(2,"i",43),o()())}function Be(t,n){if(t&1){let e=y();r(0,"div",44)(1,"div",45),m(2,"i",46),o(),r(3,"span",47),l(4),o(),r(5,"p",48),l(6),o(),r(7,"div",49)(8,"button",50),b("click",function(){h(e),p();let a=I(5);return C(a.accept())}),o(),r(9,"button",51),b("click",function(){h(e),p();let a=I(5);return C(a.reject())}),o()()()}if(t&2){let e=n.$implicit;c(4),x(e.header),c(2),x(e.message)}}var et=(()=>{let n=class n{constructor(i,a,d,f,fe,ge){this.confirmationService=i,this.productsService=a,this.messageService=d,this.router=f,this.viewportSizeService=fe,this.changeDetectorRef=ge,this.cols=[{field:"name",header:"Name"},{field:"image",header:"Image"},{field:"price",header:"Price"},{field:"countInStock",header:"Stock"},{field:"category",header:"Category"},{field:"dateCreated",header:"Created at"}]}ngOnInit(){this.listenUrlChanges(),this._observeViewportSize(),this.getProducts()}_observeViewportSize(){this.viewportSubscription=this.viewportSizeService.viewportWidth$.pipe(v(i=>i>=1025)).subscribe(i=>{this.isDesktop=i,this.changeDetectorRef.markForCheck()})}getProducts(){this.productsService.getProducts(),this.productsService.products$.pipe(v(i=>i.map(a=>T(D({},a),{category:a.category.name})))).subscribe({next:i=>{this.products=i,this.changeDetectorRef.markForCheck()}})}onDeleteProduct(i){this.confirmationService.confirm({header:"Delete Product",message:"Are you sure you want to delete this Product?",accept:()=>{this.productsService.deleteProduct(i).subscribe({next:a=>{this.products=this.products.filter(d=>d.id!==a.id),this.messageService.add({severity:"success",summary:"Success",detail:`The product "${a.name}" is deleted successfully!`}),this.changeDetectorRef.markForCheck()},error:a=>{console.error("Cannot delete product",a)}})},reject:()=>{}})}listenUrlChanges(){this.urlChangesSubscription=this.router.events.pipe(F(i=>i instanceof K)).subscribe({next:()=>{this.getProducts()},error:i=>{console.error("Cannot get url changes!",i)}})}trackByProductId(i,a){return a.id}ngOnDestroy(){this.urlChangesSubscription?.unsubscribe(),this.viewportSubscription?.unsubscribe()}};n.\u0275fac=function(a){return new(a||n)(g(ee),g(Z),g(te),g(X),g(ue),g(j))},n.\u0275cmp=M({type:n,selectors:[["admin-product-list"]],standalone:!0,features:[N],decls:8,vars:2,consts:[["class","products-page",4,"ngIf","ngIfElse"],["loader",""],["cd",""],["pTemplate","headless"],[1,"products-page"],[1,"name-page"],[1,"btn-container"],["routerLink","/products/form",1,"btn-create-edit-product"],[1,"pi","pi-plus"],["class","p-table",3,"paginator","rows","showCurrentPageReport","columns","value",4,"ngIf"],["class","products-tablet-mobile",4,"ngIf"],[1,"p-table",3,"paginator","rows","showCurrentPageReport","columns","value"],["pTemplate","header"],["pTemplate","body"],[3,"pSortableColumn","pSortableColumnDisabled",4,"ngFor","ngForOf"],[3,"pSortableColumn","pSortableColumnDisabled"],[3,"field",4,"ngIf"],[3,"field"],[4,"ngFor","ngForOf"],["styleClass","p-button-trash","icon","pi pi-trash",3,"click"],["styleClass","p-button-pencil","icon","pi pi-pencil",3,"routerLink"],[4,"ngIf"],["alt","product",3,"src",4,"ngIf"],["alt","product",3,"src"],[1,"products-tablet-mobile"],[1,"product-list"],["class","product",4,"ngFor","ngForOf","ngForTrackBy"],[1,"product"],[1,"row-1"],[1,"name-img-container"],[1,"row-2"],[1,"price-stock-container"],[1,"price"],[1,"stock"],[1,"category-date-container"],[1,"category"],[1,"date"],[1,"actions"],[1,"btn-edit-product",3,"routerLink"],[1,"pi","pi-pencil"],[1,"btn-delete-product",3,"click"],[1,"pi","pi-trash"],[1,"loader-container"],[1,"pi","pi-spin","pi-spinner"],[1,"confirm-modal","flex","flex-column","align-items-center","p-5","border-round"],[1,"icon","border-circle","inline-flex","justify-content-center","align-items-center","h-6rem","w-6rem","-mt-8"],[1,"pi","pi-question","text-5xl"],[1,"font-bold","text-2xl","block","mb-2","mt-4"],[1,"mb-0"],[1,"flex","align-items-center","gap-2","mt-4"],["pButton","","label","Save",1,"w-8rem",3,"click"],["pButton","","label","Cancel",1,"p-button-outlined","w-8rem",3,"click"]],template:function(a,d){if(a&1&&(_(0,$e,13,2,"section",0)(1,Fe,3,0,"ng-template",null,1,U),m(3,"p-toast"),r(4,"p-confirmDialog",null,2),_(6,Be,10,2,"ng-template",3),o(),m(7,"router-outlet")),a&2){let f=I(2);s("ngIf",d.products&&d.isDesktop!==void 0)("ngIfElse",f)}},dependencies:[J,A,q,H,G,Y,Q,ae,re,ce,ie,oe,ne,pe,le,_e,se,me,de],changeDetection:0});let t=n;return t})();export{et as ProductListComponent};
