import{a as pe,b as Pe,c as ye,d as Ie,e as we,f as Ee,g as ke,h as Le,i as Te,j as De}from"./chunk-YVZFOE3Y.js";import"./chunk-VX3D6ALI.js";import{a as Se,b as be}from"./chunk-SHJRNU5D.js";import{a as le}from"./chunk-RLB6QOPE.js";import{I as he,M as Ce,R as ve,b as de,e as _e,f as ue,g as me,h as ge,i as fe,n as xe}from"./chunk-COXHLCCB.js";import"./chunk-OVKFVBDW.js";import{$a as m,D as C,Da as k,Db as X,Ea as L,Eb as Y,Fa as T,Fb as Z,Ga as D,Ha as o,Ia as n,Ib as ee,Ja as _,Jb as te,Ka as U,Kb as ie,La as A,Na as v,Oa as h,P as Q,Pa as s,Sa as W,Ta as F,Ub as ne,Vb as re,Wb as oe,X as g,Xb as ce,Y as f,Ya as b,Yb as ae,Za as l,_a as S,ac as se,b as I,bb as q,cb as G,db as H,fb as J,gb as $,ha as E,hb as V,i as w,ja as a,ka as x,p as N,pb as P,qb as B,rb as j,s as O,tb as M,va as u,wb as K,xa as p}from"./chunk-5BBGCJT5.js";import{a as z,b as R}from"./chunk-6DTZ7UCQ.js";var Fe=()=>[],$e=t=>({active:t});function Me(t,r){t&1&&(o(0,"div",15)(1,"p"),_(2,"i",16),n()())}function ze(t,r){if(t&1&&_(0,"p-sortIcon",23),t&2){let e=s().$implicit;p("field",e.field)}}function Re(t,r){if(t&1&&(o(0,"th",21),u(1,ze,1,1,"p-sortIcon",22),l(2),n()),t&2){let e=r.$implicit,i=r.index;p("pSortableColumn",e.field)("pSortableColumnDisabled",i===1),a(),p("ngIf",e.field!=="image"),a(),m(" ",e.header," ")}}function Ne(t,r){if(t&1&&(o(0,"tr"),u(1,Re,3,4,"th",20),o(2,"th"),l(3,"Actions"),n()()),t&2){let e=r.$implicit;a(),p("ngForOf",e)}}function Oe(t,r){if(t&1&&(U(0),l(1),A()),t&2){let e=s().$implicit,i=s().$implicit;a(),S(i[e.field])}}function Qe(t,r){if(t&1&&_(0,"img",29),t&2){let e=s().$implicit,i=s().$implicit;p("src",i[e.field],E)}}function Ue(t,r){if(t&1&&(o(0,"span"),l(1),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),m(" ",i[e.field],"")}}function Ae(t,r){if(t&1&&(o(0,"span"),l(1),P(2,"date"),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),m(" ",j(2,1,i[e.field],"dd/MM/yyyy"),"")}}function We(t,r){if(t&1&&(o(0,"span"),l(1),P(2,"currency"),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),S(B(2,1,i[e.field]))}}function qe(t,r){if(t&1&&(o(0,"span"),l(1),n()),t&2){let e=s().$implicit,i=s().$implicit;a(),S(i[e.field])}}function Ge(t,r){if(t&1&&(o(0,"td"),u(1,Oe,2,1,"ng-container",27)(2,Qe,1,1,"img",28)(3,Ue,2,1,"span",27)(4,Ae,3,4,"span",27)(5,We,3,3,"span",27)(6,qe,2,1,"span",27),n()),t&2){let e=r.$implicit;a(),p("ngIf",e.field==="name"),a(),p("ngIf",e.field==="image"),a(),p("ngIf",e.field==="category"),a(),p("ngIf",e.field==="dateCreated"),a(),p("ngIf",e.field==="price"),a(),p("ngIf",e.field!=="image"&&e.field!=="name"&&e.field!=="category"&&e.field!=="dateCreated"&&e.field!=="price")}}function He(t,r){if(t&1){let e=v();o(0,"tr"),u(1,Ge,7,6,"td",24),o(2,"td")(3,"p-button",25),h("click",function(){let c=g(e).$implicit,d=s(3);return f(d.onDeleteProduct(c.id))}),n(),_(4,"p-button",26),n()()}if(t&2){let e=r.$implicit,i=r.columns;a(),p("ngForOf",i),a(3),F("routerLink","/products/form/",e.id,"")}}function Je(t,r){if(t&1&&(o(0,"p-table",17),u(1,Ne,4,1,"ng-template",18)(2,He,5,3,"ng-template",19),n()),t&2){let e=s(2);p("paginator",!0)("rows",10)("showCurrentPageReport",!0)("columns",e.cols)("value",e.products)}}function Ke(t,r){t&1&&(o(0,"div",13),l(1,"No Products were found!"),n())}function Xe(t,r){if(t&1){let e=v();o(0,"li",34)(1,"button",35),h("click",function(){let c=g(e).$index,d=s(4);return f(d.onClickPage(c))}),l(2),n()()}if(t&2){let e=r.$index,i=s(4);p("ngClass",V(2,$e,e+1+""===i.currPage)),a(2),m(" ",e+1," ")}}function Ye(t,r){if(t&1&&(o(0,"ul",33),T(1,Xe,3,4,"li",34,L),n()),t&2){let e=s(3);a(),D($(0,Fe).constructor(e.pageCount))}}function Ze(t,r){if(t&1){let e=v();o(0,"li",38)(1,"div",39)(2,"div",40)(3,"h1"),l(4),n(),_(5,"img",29),n()(),o(6,"div",41)(7,"div",42)(8,"p",43)(9,"span"),l(10,"Price"),n(),l(11),P(12,"currency"),n(),o(13,"p",44)(14,"span"),l(15,"Stock"),n(),l(16),n()(),o(17,"div",45)(18,"p",46)(19,"span"),l(20,"Category"),n(),l(21),n(),o(22,"p",47)(23,"span"),l(24,"Date"),n(),l(25),P(26,"date"),n()(),o(27,"div",48)(28,"button",49),_(29,"i",50),n(),o(30,"button",51),h("click",function(){let c=g(e).$implicit,d=s(4);return f(d.onDeleteProduct(c.id))}),_(31,"i",52),n()()()()}if(t&2){let e=r.$implicit;a(4),S(e.name),a(),W("src",e.image,E),a(6),m(" ",B(12,8,e.price)," "),a(5),m(" ",e.countInStock," "),a(5),m(" ",e.category," "),a(4),m(" ",j(26,10,e.dateCreated,"dd/MM/yyyy")," "),a(3),F("routerLink","/products/form/",e.id,"")}}function et(t,r){t&1&&(o(0,"div",13),l(1,"No Products were found!"),n())}function tt(t,r){if(t&1&&(o(0,"ul",36),u(1,Ze,32,13,"li",37)(2,et,2,0,"div",13),n()),t&2){let e=s(3);a(),p("ngForOf",e.products)("ngForTrackBy",e.trackByProductId),a(),k(e.products.length?-1:2)}}function it(t,r){if(t&1){let e=v();o(0,"li",34)(1,"button",35),h("click",function(){let c=g(e).$index,d=s(4);return d.setQueryParams({currPage:c+1+""}),f(d.isLoading=!0)}),l(2),n()()}if(t&2){let e=r.$index,i=s(4);p("ngClass",V(2,$e,e+1+""===i.currPage)),a(2),m(" ",e+1," ")}}function nt(t,r){if(t&1&&(o(0,"ul",33),T(1,it,3,4,"li",34,L),n()),t&2){let e=s(3);a(),D($(0,Fe).constructor(e.pageCount))}}function rt(t,r){t&1&&(o(0,"div",15)(1,"p"),_(2,"i",16),n()())}function ot(t,r){if(t&1&&(o(0,"div",30),u(1,Ye,3,1,"ul",31)(2,tt,3,3,"ul",32)(3,nt,3,1,"ul",31)(4,rt,3,0,"ng-template",null,0,M),n()),t&2){let e=b(5),i=s(2);a(),p("ngIf",i.pageCount!==void 0&&i.products.length&&!i.isLoading),a(),p("ngIf",!i.isLoading)("ngIfElse",e),a(),p("ngIf",i.pageCount!==void 0&&i.products.length&&!i.isLoading)}}function ct(t,r){if(t&1){let e=v();o(0,"section",4)(1,"div",5)(2,"h1"),l(3,"Products"),n(),o(4,"p"),l(5,"List of all products"),n()(),o(6,"div",6)(7,"button",7),_(8,"i",8),o(9,"span"),l(10,"New"),n()(),o(11,"form",9)(12,"input",10),H("ngModelChange",function(c){g(e);let d=s();return G(d.filterBy.name,c)||(d.filterBy.name=c),f(c)}),h("ngModelChange",function(){g(e);let c=s();return f(c.onSearchProducts())}),n(),u(13,Me,3,0,"div",11),n()(),u(14,Je,3,5,"p-table",12)(15,Ke,2,0,"div",13)(16,ot,6,4,"div",14),n()}if(t&2){let e=s();a(12),q("ngModel",e.filterBy.name),a(),p("ngIf",e.isDesktop&&e.isLoading),a(),p("ngIf",e.isDesktop),a(),k(e.isDesktop&&!e.products.length?15:-1),a(),p("ngIf",!e.isDesktop)}}function at(t,r){t&1&&(o(0,"div",15)(1,"p"),_(2,"i",16),n()())}function st(t,r){if(t&1){let e=v();o(0,"div",53)(1,"div",54),_(2,"i",55),n(),o(3,"span",56),l(4),n(),o(5,"p",57),l(6),n(),o(7,"div",58)(8,"button",59),h("click",function(){g(e),s();let c=b(5);return f(c.accept())}),n(),o(9,"button",60),h("click",function(){g(e),s();let c=b(5);return f(c.reject())}),n()()()}if(t&2){let e=r.$implicit;a(4),S(e.header),a(2),S(e.message)}}var Lt=(()=>{let r=class r{constructor(i,c,d,y,Ve,Be,je){this.confirmationService=i,this.productsService=c,this.messageService=d,this.router=y,this.viewportSizeService=Ve,this.changeDetectorRef=Be,this.route=je,this.cols=[{field:"name",header:"Name"},{field:"image",header:"Image"},{field:"price",header:"Price"},{field:"countInStock",header:"Stock"},{field:"category",header:"Category"},{field:"dateCreated",header:"Created at"}],this.currPage="1",this.pageSize="10",this.isFirstOnInit=!0,this.isLoading=!1,this.searchProductsSubject=new I,this.subscriptionSubject=new I}ngOnInit(){this._observeProducts(),this._observeViewportSize(),this.listenUrlChanges(),this._observeSearchProducts(),this._getFilterBy(),this.isDesktop||(this._observeQueryParams(),this.setQueryParams({currPage:this.currPage})),this.isDesktop&&this._observeQueryParams()}_getFilterBy(){this.productsService.filterBy$.pipe(C(this.subscriptionSubject)).subscribe({next:i=>{this.filterBy=i}})}_observeSearchProducts(){this.searchProductsSubject.pipe(C(this.subscriptionSubject),O(500)).subscribe({next:()=>{this.productsService.setFilterBy(this.filterBy),this.getProducts()}})}onSearchProducts(){this.isLoading=!0,this.searchProductsSubject.next("")}_observeQueryParams(){this.route.queryParams.pipe(C(this.subscriptionSubject)).subscribe(i=>{this.currPage=i.currPage||this.currPage,this.pageSize=i.pageSize||this.pageSize,this.getProducts()})}setQueryParams(i={}){this.router.navigate([],{relativeTo:this.route,queryParams:{currPage:i.currPage,pageSize:i.pageSize===""?i.pageSize:this.pageSize},queryParamsHandling:"merge"})}onClickPage(i){i+1!==+this.currPage&&(this.setQueryParams({currPage:i+1+""}),this.isLoading=!0)}_observeViewportSize(){this.viewportSizeService.viewportWidth$.pipe(C(this.subscriptionSubject),w(i=>i>=1025)).subscribe(i=>{this.isDesktop=i,i?this.setQueryParams({currPage:"",pageSize:""}):this.setQueryParams({currPage:this.currPage,pageSize:this.pageSize})})}getProducts(){this.isDesktop?this.productsService.getProducts():this.productsService.getProducts({currPage:this.currPage,pageSize:this.pageSize})}_observeProducts(){this.productsService.products$.pipe(C(this.subscriptionSubject),w(i=>i instanceof Array&&!i.length?[]:(this.pageCount=i.pageCount,i.products.map(c=>R(z({},c),{category:c.category.name}))))).subscribe({next:i=>{if(this.isFirstOnInit){this.isFirstOnInit=!1;return}this.products=i,this.isLoading=!1,this.changeDetectorRef.markForCheck()},error:i=>{console.error("Cannot get products",i)}})}onDeleteProduct(i){this.confirmationService.confirm({header:"Delete Product",message:"Are you sure you want to delete this Product?",accept:()=>{this.productsService.deleteProduct(i).subscribe({next:c=>{this.products=this.products.filter(d=>d.id!==c.id),this.messageService.add({severity:"success",summary:"Success",detail:`The product "${c.name}" is deleted successfully!`}),this.changeDetectorRef.markForCheck()},error:c=>{console.error("Cannot delete product",c)}})},reject:()=>{}})}listenUrlChanges(){let i=this.router.url.split("?")[0];this.router.events.pipe(C(this.subscriptionSubject),N(c=>c instanceof ne)).subscribe({next:c=>{let d=c.url.split("?")[0];d!==i&&(this.getProducts(),i=d)},error:c=>{console.error("Cannot get url changes!",c)}})}trackByProductId(i,c){return c.id}ngOnDestroy(){this.productsService.setFilterBy({categories:[],name:""}),this.subscriptionSubject.next(null),this.subscriptionSubject.complete()}};r.\u0275fac=function(c){return new(c||r)(x(he),x(le),x(Ce),x(ce),x(pe),x(K),x(re))},r.\u0275cmp=Q({type:r,selectors:[["admin-product-list"]],standalone:!0,features:[J],decls:8,vars:2,consts:[["loader",""],["cd",""],["class","products-page",4,"ngIf","ngIfElse"],["pTemplate","headless"],[1,"products-page"],[1,"name-page"],[1,"btn-container"],["routerLink","/products/form",1,"btn-create-edit-product"],[1,"pi","pi-plus"],[1,"search-form"],["type","text","name","name","placeholder","Search Products...",3,"ngModelChange","ngModel"],["class","loader-container",4,"ngIf"],["class","p-table",3,"paginator","rows","showCurrentPageReport","columns","value",4,"ngIf"],[1,"no-products"],["class","products-tablet-mobile",4,"ngIf"],[1,"loader-container"],[1,"pi","pi-spin","pi-spinner"],[1,"p-table",3,"paginator","rows","showCurrentPageReport","columns","value"],["pTemplate","header"],["pTemplate","body"],[3,"pSortableColumn","pSortableColumnDisabled",4,"ngFor","ngForOf"],[3,"pSortableColumn","pSortableColumnDisabled"],[3,"field",4,"ngIf"],[3,"field"],[4,"ngFor","ngForOf"],["styleClass","p-button-trash","icon","pi pi-trash",3,"click"],["styleClass","p-button-pencil","icon","pi pi-pencil",3,"routerLink"],[4,"ngIf"],["alt","product",3,"src",4,"ngIf"],["alt","product",3,"src"],[1,"products-tablet-mobile"],["class","pages",4,"ngIf"],["class","product-list",4,"ngIf","ngIfElse"],[1,"pages"],[3,"ngClass"],[3,"click"],[1,"product-list"],["class","product",4,"ngFor","ngForOf","ngForTrackBy"],[1,"product"],[1,"row-1"],[1,"name-img-container"],[1,"row-2"],[1,"price-stock-container"],[1,"price"],[1,"stock"],[1,"category-date-container"],[1,"category"],[1,"date"],[1,"actions"],[1,"btn-edit-product",3,"routerLink"],[1,"pi","pi-pencil"],[1,"btn-delete-product",3,"click"],[1,"pi","pi-trash"],[1,"confirm-modal","flex","flex-column","align-items-center","p-5","border-round"],[1,"icon","border-circle","inline-flex","justify-content-center","align-items-center","h-6rem","w-6rem","-mt-8"],[1,"pi","pi-question","text-5xl"],[1,"font-bold","text-2xl","block","mb-2","mt-4"],[1,"mb-0"],[1,"flex","align-items-center","gap-2","mt-4"],["pButton","","label","Save",1,"w-8rem",3,"click"],["pButton","","label","Cancel",1,"p-button-outlined","w-8rem",3,"click"]],template:function(c,d){if(c&1&&(u(0,ct,17,5,"section",2)(1,at,3,0,"ng-template",null,0,M),_(3,"p-toast"),o(4,"p-confirmDialog",null,1),u(6,st,10,2,"ng-template",3),n(),_(7,"router-outlet")),c&2){let y=b(2);p("ngIf",d.products&&d.isDesktop!==void 0&&d.filterBy!==void 0)("ngIfElse",y)}},dependencies:[ie,X,Y,Z,te,ee,se,oe,ae,Ie,Pe,ye,ve,be,Se,Ee,we,De,ke,Le,Te,xe,fe,de,_e,ue,ge,me],changeDetection:0});let t=r;return t})();export{Lt as ProductListComponent};
